<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>
  <!-- remote broker -->

  <bean id="remotebroker" class="org.activemq.broker.BrokerService" 
    init-method="start">
    <property name="brokerName" value = "remotebroker"/>
    <property name="persistent" value = "false"/>
    <property name="transportConnectorURIs">
      <list>
        <value>tcp://localhost:61666</value>
      </list>
      </property>
  </bean>

  <!-- JMS ConnectionFactory to use remote -->
  <bean id="remoteFactory"
    class="org.activemq.ActiveMQConnectionFactory">
    <property name="brokerURL" value="tcp://localhost:61666" />
  </bean>
  
  
  <!-- local broker with embedded Jms to Jms bridge (ok - it's contrived) -->
  <bean id="localbroker" class="org.activemq.broker.BrokerService" 
    init-method="start">
    <property name="brokerName" value = "localBroker"/>
      <property name="persistent" value = "false"/>
    <property name="transportConnectorURIs">
      <list>
        <value>tcp://localhost:61234</value>
      </list>
    </property>
    <property name="jmsBridgeConnectors">
      <list>
      	<ref bean="jmsConnector"/>
      </list>
    </property>
  </bean>
  
  <!-- JMS ConnectionFactory to use local broker (the one with the bridge) -->
  <bean id="localFactory"
    class="org.activemq.ActiveMQConnectionFactory">
    <property name="brokerURL" value="tcp://localhost:61234" />
  </bean>
  
  <!--JmsTopicConnector - the Jms bridge -->
  <bean id="jmsConnector"
  	class="org.activemq.network.jms.JmsTopicConnector">
  	<property name = "outboundTopicConnectionFactory" ref = "remoteFactory"/>
  	
  	<property name = "inboundTopicBridges">
  	 <list>
  	  <ref bean="InboundTopicBridge" />
  	 </list>
  	 </property>

  </bean>

  <bean id ="InboundTopicBridge" class="org.activemq.network.jms.InboundTopicBridge">
  	<property name = "inboundTopicName" value = "org.activemq.network.jms.TopicBridgeXBeanTest"/>
  </bean>
</beans>



